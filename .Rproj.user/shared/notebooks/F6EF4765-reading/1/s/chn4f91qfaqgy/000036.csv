"0","vulmmr %>% 
  filter(indicator == ""adjusted_approximate_vulnerable_population""|
         indicator  == ""total_pop_both_sexes"") %>% 
  select(state= state_region_name, indicator, value) %>% 
  pivot_wider(names_from = indicator, values_from = value) %>% 
  unnest() %>% 
  group_by(state) %>%  
  drop_na() %>%
  summarise(vulnerable_pop = sum(adjusted_approximate_vulnerable_population), 
            total_pop = sum(total_pop_both_sexes)) %>% 
  mutate(vulnerable_pc = vulnerable_pop / total_pop) %>% 
  left_join(ben %>%
              group_by(state) %>%
              summarise(beneficiaries = sum(beneficiaries)), by = ""state"") %>% 
  mutate(beneficiaries = ifelse(!is.na(beneficiaries), beneficiaries, 0)) %>% 
  pivot_longer(cols = c(vulnerable_pop, beneficiaries), names_to = ""type"", values_to = ""value"") %>% 
  ggplot(aes(x = fct_relevel(state, sr_ord), y = value, fill = type)) + 
  geom_col(position = ""dodge"")+
  theme(axis.text.x = element_text(angle = 60, vjust = 0.5, hjust = 0.5)) +
  theme(legend.title = element_blank()) +
  labs(x = """",
       y = """", 
       title = ""Beneficiaries and vulnerable population (MIMU)"") +
  scale_y_continuous(labels = comma)
"
"2","Warning:"
"2"," Values are not uniquely identified; output will contain list-cols.
* Use `values_fn = list` to suppress this warning.
* Use `values_fn = length` to identify where the duplicates arise
* Use `values_fn = {summary_fun}` to summarise duplicates
"
"2","Warning:"
"2"," `cols` is now required when using unnest().
Please use `cols = c(adjusted_approximate_vulnerable_population, total_pop_both_sexes)`
"
